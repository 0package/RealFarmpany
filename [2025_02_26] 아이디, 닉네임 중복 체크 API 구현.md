# 아이디, 닉네임 중복 체크 API 구현

날짜: 2025년 2월 26일
선택: 서버

1. 회원가입 버튼을 누르면 아이디 중복 체크, 닉네임 중복 체크, 서버에 사용자 저장하는 API
2. 아이디 중복 체크, 닉네임 중복 체크, 새로운 유저 저장하는 각각의 API

2가지의 방법중 2번 방법을 선택했습니다.

2번 선택 이유:

- 코드의 가독성 및 유지보수
- 회원가입 버튼에 API를 집중시키면 아이디를 입력하고 즉각적으로 중복확인을 할 수 가 없음
- 그렇기에 입력마다 체크하기 위해 API 분할을 선택

```jsx
// 아이디 중복 확인 API
app.get('/check-userid', (req, res) => {
  const { user_id } = req.query;
  const query = 'SELECT * FROM users WHERE user_id = ?';
  db.query(query, [user_id], (err, results) => {
      if (err) {
          console.error('[GET /check-userid] 쿼리 실행 실패:', err);
          return res.status(500).json({ message: '서버 오류' });
      }
      if (results.length > 0) {
          console.log(`[GET /check-userid] 이미 사용 중인 아이디: ${user_id}`);
          return res.status(400).json({ message: '이미 사용 중인 아이디입니다.' });
      }
      console.log(`[GET /check-userid] 사용 가능한 아이디: ${user_id}`);
      res.status(200).json({ message: '사용 가능한 아이디입니다.' });
  });
});

// 닉네임 중복 확인 API
app.get('/check-username', (req, res) => {
  const { username } = req.query;
  const query = 'SELECT * FROM users WHERE username = ?';
  db.query(query, [username], (err, results) => {
      if (err) {
          console.error('[GET /check-username] 쿼리 실행 실패:', err);
          return res.status(500).json({ message: '서버 오류' });
      }
      if (results.length > 0) {
          console.log(`[GET /check-username] 이미 사용 중인 닉네임: ${username}`);
          return res.status(400).json({ message: '이미 사용 중인 닉네임입니다.' });
      }
      console.log(`[GET /check-username] 사용 가능한 닉네임: ${username}`);
      res.status(200).json({ message: '사용 가능한 닉네임입니다.' });
  });
});

// 회원가입 API
app.post('/signup', (req, res) => {
  const { user_id, password, username } = req.body;
  const insertUserQuery = 'INSERT INTO users (user_id, password, username) VALUES (?, ?, ?)';
  db.query(insertUserQuery, [user_id, password, username], (err) => {
      if (err) {
          console.error('[POST /signup] 회원가입 실패:', err);
          return res.status(500).json({ message: '회원가입 실패' });
      }
      console.log(`[POST /signup] 회원가입 성공 - user_id: ${user_id}`);
      res.status(201).json({ message: '회원가입 성공' });
  });
});
```